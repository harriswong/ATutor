var fluid=fluid||{};(function(L,F){var D=F.roles.LIST;var B="message-bundle:";var I={defaultStyle:"orderable-default",selected:"orderable-selected",dragging:"orderable-dragging",hover:"orderable-hover",dropMarker:"orderable-drop-marker",avatar:"orderable-avatar"};var A=function(N){var M=L(N).clone();M.removeAttr("id");L("[id]",M).removeAttr("id");L(":hidden",M).remove();L("input",M).attr("disabled","true");M.removeClass("ui-droppable");return M};function G(N){var M=F.wrap(N.selectables());if(M.length<=0){return null}return M[0]}function H(N,O,P,Q,M){N.focus(O);N.keydown(P);N.keyup(Q);N.mousemove(M);if(L.browser.msie){N[0].ondrag=function(){return false};N[0].onselectstart=function(){return false}}}function K(M,N,P){var O=G(N);if(O){M.ariaState("activedescendent",O.id)}M.ariaRole(P.container);M.ariaState("multiselectable","false");M.ariaState("readonly","false");M.ariaState("disabled","false")}function J(M,N){M.removeClass(N.selected);M.addClass(N.defaultStyle);M.ariaState("selected","false")}var E={};E.findTarget=function(N,S,P,R){var M=function(T){return(T&&T.id===P)};var Q=function(T){return((S.index(T)>-1)||M(T))};var O=Q(N)?N:L.grep(L(N).parents(),Q)[0];if(M(O)){O=R?R[0]:null}return O};E.createAvatarId=function(M){return M+"_avatar"};var C=function(N,M){if(M&&!(M instanceof Array)){M=[M]}return M||N};F.Reorderer=function(b,Z,U,R){var Q=this;this.domNode=L(b);this.activeItem=undefined;Z=F.utils.adaptFindItems(Z);R=R||{};var h=R.role||D;var a=R.instructionMessageId||B;var P=C(F.defaultKeysets,R.keysets);this.cssClasses=R.cssClassNames||I;var O=R.avatarCreator||A;this.focusActiveItem=function(i){if(!Q.activeItem){var j=G(Z);if(!j){return i.stopPropagation()}L(j).focus()}else{L(Q.activeItem).focus()}return i.stopPropagation()};var d=function(j){var k=0;for(k;k<P.length;k++){if(P[k].modifier(j)){return true}}return false};var N=function(){return(L.inArray(Q.activeItem,Z.movables())>=0)};this.handleKeyDown=function(i){if(!Q.activeItem||(Q.activeItem!==i.target)){return true}var j=L(Q.activeItem);if(!j.hasClass(Q.cssClasses.dragging)&&d(i)){if(N()){j.removeClass(Q.cssClasses.selected);j.addClass(Q.cssClasses.dragging);j.ariaState("grab","true")}return false}return Q.handleDirectionKeyDown(i)};this.handleKeyUp=function(i){if(!Q.activeItem||(Q.activeItem!==i.target)){return true}var j=L(Q.activeItem);if(j.hasClass(Q.cssClasses.dragging)&&!d(i)){if(N()){j.removeClass(Q.cssClasses.dragging);j.addClass(Q.cssClasses.selected);j.ariaState("grab","supported");return false}}};var e=function(i){if(N()){i(Q.activeItem);Q.activeItem.focus();L(Q.activeItem).removeClass(Q.cssClasses.selected)}};var Y=function(i){return(!i.ctrlKey&&!i.altKey&&!i.shiftKey&&!i.metaKey)};var X=function(l,j,i){var k=false;switch(l){case j.up:e(i.moveItemUp);k=true;break;case j.down:e(i.moveItemDown);k=true;break;case j.left:e(i.moveItemLeft);k=true;break;case j.right:e(i.moveItemRight);k=true;break}return k};var g=function(m,k,j,n){var i=false;var l;switch(m){case k.up:l=j.getItemAbove(n);i=true;break;case k.down:l=j.getItemBelow(n);i=true;break;case k.left:l=j.getLeftSibling(n);i=true;break;case k.right:l=j.getRightSibling(n);i=true;break}L(l).focus();return i};this.handleDirectionKeyDown=function(j){if(!Q.activeItem){return true}for(var k=0;k<P.length;k++){var l=P[k];var m=false;if(l.modifier(j)){m=X(j.keyCode,l,U)}else{if(Y(j)){m=g(j.keyCode,l,U,Q.activeItem)}}if(m){return false}}return true};var S;var M;var T=function(j){j=F.wrap(j);var i=E.createAvatarId(Q.domNode.id);return function(l){if(M){var m=E.findTarget(l.target,j,i,M);if(m){var k=U.dropPosition(m,Q.activeItem,l.clientX,l.pageY);if(k===F.position.BEFORE){L(m).before(S);S.show()}else{if(k===F.position.AFTER){L(m).after(S);S.show()}else{if(k===F.position.INSIDE){L(m).append(S);S.show()}else{S.hide()}}}}else{S.hide()}}}};function W(i){i.addClass(Q.cssClasses.defaultStyle);i.ariaState("grab","supported");i.mouseover(function(){var j=L(Z.grabHandle(i[0]));j.addClass(Q.cssClasses.hover)});i.mouseout(function(){var j=L(Z.grabHandle(i[0]));j.removeClass(Q.cssClasses.hover)});i.draggable({refreshPositions:true,scroll:true,helper:function(){var j=L(O(i[0]));j.addClass(Q.cssClasses.avatar);j.attr("id",E.createAvatarId(Q.domNode.id));return j},start:function(k,j){i.focus();i.removeClass(Q.cssClasses.selected);i.addClass(Q.cssClasses.dragging);i.ariaState("grab","true");S=L(document.createElement(i[0].tagName));S.addClass(Q.cssClasses.dropMarker);S.hide()},stop:function(k,j){i.removeClass(Q.cssClasses.dragging);i.addClass(Q.cssClasses.selected);L(Q.activeItem).ariaState("grab","supported");S.remove();j.helper=null;M=null},handle:Z.grabHandle(i[0])})}function f(j,i){j.ariaState("dropeffect","move");j.droppable({accept:i,greedy:true,tolerance:"pointer",over:function(l,k){M=k.element},drop:function(l,k){U.mouseMoveItem(k.draggable[0],j[0],l.clientX,l.pageY);Q.activeItem.focus()}})}var c=function(j){var m=function(i){J(L(this),Q.cssClasses);return i.stopPropagation()};var n=function(i){Q.selectItem(this);return i.stopPropagation()};for(var k=0;k<j.length;k++){var l=L(j[k]);l.tabindex("-1");l.blur(m);l.focus(n);l.ariaRole(h.item);l.ariaState("selected","false");l.ariaState("disabled","false")}};var V=function(){var j;var n=F.wrap(Z.movables());var m=F.wrap(Z.dropTargets());c(F.wrap(Z.selectables()));for(j=0;j<n.length;j++){var l=n[j];W(L(l))}var k=function(i){return(n.index(i[0])>-1)};for(j=0;j<m.length;j++){f(L(m[j]),k)}};if(this.domNode){H(this.domNode,Q.focusActiveItem,Q.handleKeyDown,Q.handleKeyUp,T(Z.dropTargets()));K(this.domNode,Z,h);if(!this.domNode.hasTabindex()||(this.domNode.tabindex()<0)){this.domNode.tabindex("0")}V()}};F.Reorderer.prototype.selectItem=function(N){if(this.activeItem&&this.activeItem!==N){J(L(this.activeItem),this.cssClasses)}this.activeItem=N;var M=L(N);M.removeClass(this.cssClasses.defaultStyle);M.addClass(this.cssClasses.selected);M.ariaState("selected","true");this.domNode.ariaState("activedescendent",N.id)}})(jQuery,fluid);(function(D,C){var B=function(H,G,F,J){var I=F;if(G.hasWrapped){I=J}if(I===C.position.AFTER){D(G.item).after(H)}else{D(G.item).before(H)}};var E=function(K,G,F,J){var H;var I;if(G===C.orientation.VERTICAL){H=D(K).offset().top+(K.offsetHeight/2);I=J<H}else{H=D(K).offset().left+(K.offsetWidth/2);I=F<H}return(I?C.position.BEFORE:C.position.AFTER)};var A={getSiblingInfo:function(H,G,J){var F=D(G).index(H)+J;var I=false;if(F===-1){F=G.length-1;I=true}else{if(F===G.length){F=0;I=true}else{if(F<-1||F>G.length){F=0}}}return{item:G[F],hasWrapped:I}},getRightSiblingInfo:function(G,F){return this.getSiblingInfo(G,F,C.direction.NEXT)},getLeftSiblingInfo:function(G,F){return this.getSiblingInfo(G,F,C.direction.PREVIOUS)},getItemInfoBelow:function(L,F){var J=D(L).offset();var H,I;var K,G;for(H=0;H<F.length;H++){G=F[H];I=D(F[H]).offset();if(I.left===J.left){K=K||G;if(I.top>J.top){return{item:G,hasWrapped:false}}}}K=K||F[0];return{item:K,hasWrapped:true}},getItemInfoAbove:function(L,G){var K=D(L).offset();var I,J;var F,H;for(I=G.length-1;I>-1;I--){H=G[I];J=D(G[I]).offset();if(J.left===K.left){F=F||H;if(K.top>J.top){return{item:H,hasWrapped:false}}}}F=F||G[0];return{item:F,hasWrapped:true}}};C.ListLayoutHandler=function(H,I){H=C.utils.adaptFindItems(H);var G=function(){};var F=C.orientation.VERTICAL;if(I){G=I.orderChangedCallback||G;F=I.orientation||F}this.getRightSibling=function(J){return A.getRightSiblingInfo(J,H.selectables()).item};this.moveItemRight=function(K){var J=A.getRightSiblingInfo(K,H.movables());B(K,J,C.position.AFTER,C.position.BEFORE);G()};this.getLeftSibling=function(J){return A.getLeftSiblingInfo(J,H.selectables()).item};this.moveItemLeft=function(K){var J=A.getLeftSiblingInfo(K,H.movables());B(K,J,C.position.BEFORE,C.position.AFTER);G()};this.getItemBelow=this.getRightSibling;this.getItemAbove=this.getLeftSibling;this.moveItemUp=this.moveItemLeft;this.moveItemDown=this.moveItemRight;this.dropPosition=function(L,K,J,M){return E(L,F,J,M)};this.mouseMoveItem=function(K,M,J,N){var L=this.dropPosition(M,K,J,N);if(L===C.position.BEFORE){D(M).before(K)}else{if(L===C.position.AFTER){D(M).after(K)}}G()}};C.GridLayoutHandler=function(H,I){C.ListLayoutHandler.call(this,H,I);H=C.utils.adaptFindItems(H);var G=function(){};if(I){G=I.orderChangedCallback||G}var F=C.orientation.HORIZONTAL;this.getItemBelow=function(J){return A.getItemInfoBelow(J,H.selectables()).item};this.moveItemDown=function(K){var J=A.getItemInfoBelow(K,H.movables());B(K,J,C.position.AFTER,C.position.BEFORE);G()};this.getItemAbove=function(J){return A.getItemInfoAbove(J,H.selectables()).item};this.moveItemUp=function(K){var J=A.getItemInfoAbove(K,H.movables());B(K,J,C.position.BEFORE,C.position.AFTER);G()};this.dropPosition=function(L,K,J,M){return E(L,F,J,M)}};C.ModuleLayoutHandler=function(L,J,O){var G=C.orientation.VERTICAL;var N=function(){};if(O){if(O.orderChangedCallbackUrl){N=function(){D.post(O.orderChangedCallbackUrl,JSON.stringify(L),function(P,Q){J=P},"json")}}}var K=function(P,R){var Q=C.moduleLayout.itemAboveBelow(P.id,R,L);return C.utils.jById(Q)[0]};var M=function(P,Q){var R=C.moduleLayout.firstItemInAdjacentColumn(P.id,Q,L);return C.utils.jById(R)[0]};var I=function(R,Q,P){if(!R||!Q||!C.moduleLayout.canMove(R.id,Q.id,P,L,J)){return }if(P===C.position.BEFORE){D(Q).before(R)}else{if(P===C.position.AFTER){D(Q).after(R)}else{D(Q).append(R)}}C.moduleLayout.updateLayout(R.id,Q.id,P,L);N()};var H=function(P,R){var S=C.moduleLayout.findTarget(P.id,R,L,J);var Q=C.utils.jById(S.id)[0];I(P,Q,S.position)};var F=function(P,S){var R=C.moduleLayout.nearestMoveableTarget(P.id,S,L,J);var Q=C.utils.jById(R.id)[0];I(P,Q,R.position)};this.getRightSibling=function(P){return M(P,C.direction.NEXT)};this.moveItemRight=function(P){H(P,C.direction.NEXT)};this.getLeftSibling=function(P){return M(P,C.direction.PREVIOUS)};this.moveItemLeft=function(P){H(P,C.direction.PREVIOUS)};this.getItemAbove=function(P){return K(P,C.direction.PREVIOUS)};this.moveItemUp=function(P){F(P,C.direction.PREVIOIUS)};this.getItemBelow=function(P){return K(P,C.direction.NEXT)};this.moveItemDown=function(P){F(P,C.direction.NEXT)};this.dropPosition=function(T,R,Q,U){if(C.moduleLayout.isColumn(T.id,L)){return C.position.INSIDE}var P=E(T,G,Q,U);var S=C.moduleLayout.canMove(R.id,T.id,P,L,J);if(S){return P}else{return C.position.NO_TARGET}};this.mouseMoveItem=function(Q,R,P,T){var S=this.dropPosition(R,Q,P,T);if(S!==C.position.NO_TARGET){I(Q,R,S)}}}})(jQuery,fluid);fluid.moduleLayout=function(C,B){var A={layoutWalker:function(G,H){for(var E=0;E<H.columns.length;E++){var I=H.columns[E].children;for(var F=0;F<I.length;F++){var D=G(I,F,E);if(D){return D}}}},findColumnAndItemIndices:function(G,E){var D=function(J,I,H){if(J[I]===G){return{columnIndex:H,itemIndex:I}}};var F=A.layoutWalker(D,E);return F||{columnIndex:-1,itemIndex:-1}},findColIndex:function(F,E){for(var D=0;D<E.columns.length;D++){if(F===E.columns[D].id){return D}}return -1},findItemIndex:function(E,D){return A.findColumnAndItemIndices(E,D).itemIndex},numColumns:function(D){return D.columns.length},isColumnIndex:function(D,E){return(D<E.columns.length)&&(D>=0)},findItemAndTargetIndices:function(L,M,H,K){var D=K.columns;var J={itemIndex:-1,targetIndex:-1};if(!L||!M){return J}var F=0;var O=H;for(var G=0;G<D.length;G++){var N=D[G].children;for(var E=0;E<N.length;E++){var I=N[E];if(I===L){J.itemIndex=F}if(I===M){J.targetIndex=O}if(J.itemIndex>=0&&J.targetIndex>=0){return J}F++;O++}O++}return J},nearestNextMoveableTarget:function(H,G,J){var E={id:H,position:B.position.AFTER};var K=false;var I=A.findColumnAndItemIndices(H,G);if(I.columnIndex<0){K=true}if(!K){var L=G.columns[I.columnIndex].children;for(var F=I.itemIndex+1;(F<L.length)&&!K;F++){var D=L[F];if((K=B.moduleLayout.canMove(H,D,B.position.AFTER,G,J))){E.id=D}}}return E},nearestPreviousMoveableTarget:function(H,G,J){var E={id:H,position:B.position.BEFORE};var K=false;var I=A.findColumnAndItemIndices(H,G);if(I.columnIndex<0){K=true}if(!K){var L=G.columns[I.columnIndex].children;for(var F=I.itemIndex-1;(F>-1)&&!K;F--){var D=L[F];if((K=B.moduleLayout.canMove(H,D,B.position.BEFORE,G,J))){E.id=D}}}return E},getItemAt:function(E,D,F){var I=null;var H=F.columns;if(E>=0&&E<H.length){var G=H[E].children;if(D>=0&&D<G.length){I=G[D]}}return I},canItemMove:function(F,E){var G=E[F];for(var D=0;D<G.length;D++){if(G[D]===1){return true}}return false},isDropTarget:function(F,E){for(var D=0;D<E.length;D++){if(E[D][F]===1||E[D][F+1]===1){return true}}return false}};return{internals:A,isColumn:function(F,E){var D=A.findColIndex(F,E);return(D>-1)},canMove:function(I,H,D,F,E){if(D===B.position.NO_TARGET){return false}if(D===B.position.INSIDE){return true}var G=A.findItemAndTargetIndices(I,H,D,F);return(!!E[G.itemIndex][G.targetIndex])},firstItemInAdjacentColumn:function(G,F,D){var E=function(K,I,H){var M=K[I];if(M===G){var J=H+F;var L=A.getItemAt(J,0,D);while(!L){J=J+F;if(A.isColumnIndex(J,D)){L=A.getItemAt(J,0,D)}else{L=G}}return L}};return A.layoutWalker(E,D)||G},itemAboveBelow:function(G,F,E){var D=function(I,H){if(I[H]===G){var J=H+F;if((J<0)||(J>=I.length)){return G}else{return I[J]}}};return A.layoutWalker(D,E)||G},updateLayout:function(H,F,E,G){if(!H||!F||H===F){return }var D=A.findColumnAndItemIndices(H,G);G.columns[D.columnIndex].children.splice(D.itemIndex,1);var J;if(E===B.position.INSIDE){J=G.columns[A.findColIndex(F,G)].children;J.splice(J.length,0,H)}else{var I=A.findColumnAndItemIndices(F,G);J=G.columns[I.columnIndex].children;J.splice(I.itemIndex+E,0,H)}},findTarget:function(G,I,F,J){var H=A.findColumnAndItemIndices(G,F).columnIndex+I;var D=F.columns[H];if(H<0||H>=A.numColumns(F)){return{id:G,position:B.position.BEFORE}}var L=D.children;for(var E=0;(E<L.length);E++){var K=L[E];if(B.moduleLayout.canMove(G,K,B.position.BEFORE,F,J)){return{id:K,position:B.position.BEFORE}}else{if(B.moduleLayout.canMove(G,K,B.position.AFTER,F,J)){return{id:K,position:B.position.AFTER}}}}return{id:D.id,position:B.position.INSIDE}},nearestMoveableTarget:function(G,F,E,D){if(F===B.direction.NEXT){return A.nearestNextMoveableTarget(G,E,D)}else{return A.nearestPreviousMoveableTarget(G,E,D)}},createFindItems:function(K,O,R){var F={};F.grabHandle=R;var I;var D;var M;var N=K.columns;for(var J=0;J<N.length;J++){var Q=N[J].children;for(var H=0;H<Q.length;H++){var L=Q[H];var G="[id="+L+"]";I=I?I+","+G:G;var P=A.findItemAndTargetIndices(L,L,B.position.BEFORE,K);if(A.canItemMove(P.itemIndex,O)){D=D?D+","+G:G}if(A.isDropTarget(P.targetIndex,O)){M=M?M+","+G:G}}var E="[id="+N[J].id+"]";M=M?M+","+E:E}F.selectables=function(){return C(I)};F.movables=function(){return C(D)};F.dropTargets=function(){return C(M)};return F},containerId:function(D){return D.id}}}(jQuery,fluid);